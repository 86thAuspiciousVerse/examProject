{% extends "base.html" %}
{% load static %}

{% block title %}
我的收藏
{% endblock %}

{% block content %}
<!-- 广告横幅 -->
<div class="container-fluid">
    <div class="row">
        <img class="img-responsive model-img" src="{% static 'img/user.jpg' %}" 
                 alt="用户中心">
    </div>
</div>

<!-- 主体内容 -->
<div class="container">
    <div class="row row-3">
        <!-- 侧边导航栏 -->
        <div class="col-md-3">
            <div class="model-title">
                用户中心
            </div>
            <div class="model-list">
                <ul class="list-group">
                    <li class="list-group-item" id="register">
                        <a href="{% url 'userApp:register' %}">用户注册</a>
                    </li>
                    <li class="list-group-item" id="login">
                        <a href="{% url 'userApp:login' %}">用户登录</a>
                    </li>
                    <li class="list-group-item" id="data">
                        <a href="{% url 'userApp:data' %}">个人资料</a>
                    </li>
                    <li class="list-group-item active" id="collect">
                        <a href="{% url 'userApp:collect' %}">我的收藏</a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- 说明文字和图片 -->
        <div class="col-md-9">
            <div class="model-details-title">
                我的收藏
            </div>
            <div class="model-details">
                <div class="row">
                    <img class="img-responsive" src="{% static 'img/collect.jpg' %}">
                </div>
                <p>
                    这是您收藏的电影列表。您可以随时查看这些电影的详细信息，也可以取消收藏。
                </p>
                
                <div class="row">
                    {% if collections %}
                    {% for collection in collections %}
                    <div class="col-md-4">
                        <div class="thumbnail" style="border: 1px solid #ddd; padding: 10px; margin-bottom: 20px;">
                            <div class="caption">
                                <h5>{{ collection.movie.title }}</h5>
                                
                                <!-- 修复：添加海报显示 -->
                                {% if collection.movie.poster %}
                                    <img src="{{ collection.movie.poster.url }}" 
                                         alt="{{ collection.movie.title }}"
                                         style="width: 100%; height: 200px; object-fit: cover; margin-bottom: 10px;">
                                {% else %}
                                    <img src="https://via.placeholder.com/300x200/ffc107/333?text={{ collection.movie.title }}" 
                                         alt="{{ collection.movie.title }}"
                                         style="width: 100%; height: 200px; object-fit: cover; margin-bottom: 10px;">
                                {% endif %}
                                
                                <p>分类：{{ collection.movie.category.name }}</p>
                                <p>评分：⭐ {{ collection.movie.rating }}</p>
                                <p>收藏时间：{{ collection.collected_at|date:"Y-m-d" }}</p>
                                <p>
                                    <a href="{% url 'moviesApp:details' collection.movie.id %}" class="btn btn-primary btn-sm">查看详情</a>
                                </p>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                    {% else %}
                    <div class="col-md-12">
                        <div class="alert alert-info">
                            <p>您还没有收藏任何电影。</p>
                            <p><a href="{% url 'moviesApp:category' %}">去浏览电影</a></p>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}