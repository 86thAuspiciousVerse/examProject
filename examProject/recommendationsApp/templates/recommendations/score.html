{% extends "base.html" %}
{% load static %}

{% block title %}
评分推荐
{% endblock %}

{% block content %}
<!-- 广告横幅 -->
<div class="container-fluid">
    <div class="row">
        <img class="img-responsive model-img" src="{% static 'img/recommendation.jpg' %}" 
                 alt="评分推荐横幅">
    </div>
</div>

<!-- 主体内容 -->
<div class="container">
    <div class="row row-3">
        <!-- 侧边导航栏 -->
        <div class="col-md-3">
            <div class="model-title">
                推荐中心
            </div>
            <div class="model-list">
                <ul class="list-group">
                    <li class="list-group-item active" id="score">
                        <a href="{% url 'recommendationsApp:score' %}">评分推荐</a>
                    </li>
                    <li class="list-group-item" id="type">
                        <a href="{% url 'recommendationsApp:type' %}">类型推荐</a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- 说明文字和图片 -->
        <div class="col-md-9">
            <div class="model-details-title">
                基于评分的电影推荐
            </div>
            <div class="model-details">
                <div class="row">
                    <img class="img-responsive" src="{% static 'img/score.jpg' %}">
                </div>
                <p>
                    评分推荐功能根据用户的评分数据，为您推荐评分最高的电影。这些电影经过大量用户的评价和验证，具有很高的观看价值。无论是经典老片还是热门新片，高评分通常意味着更好的观影体验。我们整理出评分前10的电影，供您参考选择。
                </p>
                
                <h4>高分电影推荐</h4>
                <div class="row">
                    {% for movie in movies %}
                    <div class="col-md-4">
                        <div class="thumbnail" style="border: 1px solid #ddd; padding: 10px; margin-bottom: 20px;">
                            <div class="caption">
                                <h5>{{ movie.title }}</h5>
                                
                                <!-- 修复：添加海报显示 -->
                                {% if movie.poster %}
                                    <img src="{{ movie.poster.url }}" 
                                         alt="{{ movie.title }}"
                                         style="width: 100%; height: 200px; object-fit: cover; margin-bottom: 10px;">
                                {% else %}
                                    <img src="https://via.placeholder.com/300x200/ffc107/333?text={{ movie.title }}" 
                                         alt="{{ movie.title }}"
                                         style="width: 100%; height: 200px; object-fit: cover; margin-bottom: 10px;">
                                {% endif %}
                                
                                <p>分类：{{ movie.category.name }}</p>
                                <p>评分：⭐ {{ movie.rating }}</p>
                                <p>导演：{{ movie.director }}</p>
                                <p>
                                    <a href="{% url 'moviesApp:details' movie.id %}" class="btn btn-primary btn-sm">查看详情</a>
                                </p>
                            </div>
                        </div>
                    </div>
                    {% empty %}
                    <div class="col-md-12">
                        <div class="alert alert-info">暂无电影数据</div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}